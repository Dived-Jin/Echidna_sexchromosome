# Ampliconic Annotation
This pipeline is used to annotate ampliconic regions in echidna sex chromosome analysis, including the following scripts:

## Annotation
AmpliconRegion.sh  
Usage: sh AmpliconRegion.sh -f X.fasta -b X.bed -o <abs_outpath> -p Echidna -fq1 NG_1.fq.gz -fq2 NG_2.fq.gz -d 18  
  -f: nonPARX or nonPARY sequences in FASTA format.  
  -b: nonPARX/Y region in BED format  
  -p: output prefix
  -fq1 & -fq2: path to NGS data   
  -d: whole genome sequencing depth

## Orthologs cluster
MCLcluster.sh  
Usage: sh MCLcluster.sh all.pep.fasta gene.annotation  
  all.pep.fasta: All protein sequences.  
  gene.annotation:  Gene function file in two columns (Gene_id, Gene_name) such as the following:  
  XP.111111 AMHK  
  XP.111112 AMHK  

## Ampliconic family classification 
AmpliconStats.sh  
Usage: sh AmpliconStats.sh Ags.txt PlatySex.assign EchidnaSex.assign Mcl.txt Echidna_vs_chicken.aln Platypus_vs_chicken.aln Platypus.Sexgene.list Echidna.Sexgene.list  Chicken.gene.list   
  Ags.txt: Ampliconic genes list in one column (Gene_id).  
  PlatySex.assign &  EchidnaSex.assign:  The XY nonPAR region file include four columns (scaffold_id, start, end, sex chromosome id) such as the following:  
    chrX1	0	100000	chrX1  
    SUPER_Y1 0	100000	chrY1
  Mcl.txt: Ortholog gene family list generated by MCL methods.  
  Echidna_vs_chicken.aln & Platypus_vs_chicken.aln:  Whole genome alignment generated by lastZ.  
  Platypus.Sexgene.list , Echidna.Sexgene.list  & Chicken.gene.list: Gene function file with two columns (Gene_id, Gene_name) such as the following:  
  XP.111111 AMHk  
  XP.111112 AMHk  

## Circos plot
Align_paint.sh  
Usage: sh Align_paint.sh Echidna.X.fasta Platypus.X.fasta Echidna.X.AGs Platypus.X.AGs Mcl.class.file  Echidna.Sexchr.assign Platypus.Sexchr.assign   
  Echidna.X.fasta & Platypus.X.fasta: X sequences include PAR sequences with fasta format.  
  Echidna.X.AGs & Platypus.X.AGs: Ampliconic genes list include four columns (scaffold_id, start, end, geneid) such as the following:  
  chr1  1 10000 XP.111111  
  chr1  20000 30000 XP.111112  
  Mcl.class.file: The result of ampliconic genes classification generated by `AmpliconStats.sh`.  
  Echidna.Sexchr.assign Platypus.Sexchr.assign: The sex chromesome region file with three columns(chrid,start,end).  
  chr1  0 1000000  
  chr2  0 9000000  
